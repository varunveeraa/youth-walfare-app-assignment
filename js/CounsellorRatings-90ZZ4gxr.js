import{r,c as d,j as q,a as i,b as e,f as k,t as c,F as m,D as p,d as x,v as A,z as S,i as C,u as D,o as n,y as g}from"./vendor-BmZR9K5F.js";import{_ as z,u as H}from"./index-csEBr71G.js";import{d as O}from"./useFirestore-Bf5FwK2U.js";import{w as T,x as U,y as j}from"./firebase-w6XYyoFK.js";import{R as F}from"./RatingSystem-BsviHeSt.js";import"./mapbox-Dy2hBtBs.js";import"./collections-BIJkFGz0.js";import"./validation-BV3KGR2z.js";const G={class:"counsellor-ratings"},J={class:"container"},W={class:"row"},K={class:"col s12 m6"},Q={class:"card"},X={class:"card-content center-align"},Y={class:"rating-display-large"},Z={class:"rating-number"},$={class:"stars"},ee={class:"grey-text"},se={class:"col s12 m6"},te={class:"card"},ae={class:"card-content"},oe={class:"row"},ie={class:"col s12"},ne={class:"card"},le={class:"card-content"},re={class:"row"},de={class:"col s12 m4 center-align"},ce={class:"category-score"},ue={class:"score"},ve={class:"stars"},me={class:"col s12 m4 center-align"},pe={class:"category-score"},ge={class:"score"},he={class:"stars"},fe={class:"col s12 m4 center-align"},_e={class:"category-score"},we={class:"score"},ye={class:"stars"},be={class:"row"},Re={class:"col s12 m6"},ke={class:"input-field"},xe={class:"col s12 m6"},Ae={class:"input-field"},Se={key:0,class:"center-align"},Ce={class:"row"},De={class:"col s12"},Fe={class:"card"},Me={class:"card-content"},Be={key:1,class:"center-align"},Ne=["disabled"],Ve={__name:"CounsellorRatings",setup(Ie){const{user:u}=H(),{getAllRatings:B,loading:w}=O(),o=r([]),v=r(""),h=r("newest"),y=r(!0),f=r(20),_=d(()=>o.value.length===0?0:o.value.reduce((s,t)=>s+t.rating,0)/o.value.length),b=d(()=>o.value.length),N=d(()=>{const a={5:0,4:0,3:0,2:0,1:0};return o.value.forEach(s=>{a[s.rating]++}),a}),l=d(()=>{const a={communication:0,helpfulness:0,professionalism:0},s={communication:0,helpfulness:0,professionalism:0};return o.value.forEach(t=>{t.communication&&(a.communication+=t.communication,s.communication++),t.helpfulness&&(a.helpfulness+=t.helpfulness,s.helpfulness++),t.professionalism&&(a.professionalism+=t.professionalism,s.professionalism++)}),{communication:s.communication>0?a.communication/s.communication:0,helpfulness:s.helpfulness>0?a.helpfulness/s.helpfulness:0,professionalism:s.professionalism>0?a.professionalism/s.professionalism:0}}),V=d(()=>{let a=[...o.value];switch(v.value&&(a=a.filter(s=>s.rating===parseInt(v.value))),h.value){case"oldest":a.sort((s,t)=>new Date(s.createdAt)-new Date(t.createdAt));break;case"highest":a.sort((s,t)=>t.rating-s.rating);break;case"lowest":a.sort((s,t)=>s.rating-t.rating);break;default:a.sort((s,t)=>new Date(t.createdAt)-new Date(s.createdAt))}return a}),R=async()=>{try{const a=[T("counsellorId","==",u.value.uid),U("createdAt","desc"),j(f.value)],s=await B(a);o.value=s,y.value=s.length===f.value}catch(a){console.error("Error loading reviews:",a)}},I=()=>{},L=()=>{},E=()=>{f.value+=20,R()};q(async()=>{M.FormSelect.init(document.querySelectorAll("select")),await R(),o.value.length===0&&(o.value=P())});const P=()=>[{id:"1",rating:5,review:"Dr. Johnson was incredibly helpful and understanding. She provided practical strategies that really made a difference in managing my anxiety.",communication:5,helpfulness:5,professionalism:5,reviewerName:"Sarah M.",isAnonymous:!1,createdAt:new Date("2024-01-15"),counsellorId:u.value.uid},{id:"2",rating:4,review:"Great session, felt heard and supported. Would recommend to others dealing with similar issues.",communication:4,helpfulness:4,professionalism:5,reviewerName:"Anonymous",isAnonymous:!0,createdAt:new Date("2024-01-10"),counsellorId:u.value.uid},{id:"3",rating:5,review:"Professional, empathetic, and knowledgeable. The techniques shared have been very beneficial.",communication:5,helpfulness:5,professionalism:5,reviewerName:"Mike T.",isAnonymous:!1,createdAt:new Date("2024-01-08"),counsellorId:u.value.uid}];return(a,s)=>(n(),i("div",G,[e("div",J,[s[14]||(s[14]=e("div",{class:"row"},[e("div",{class:"col s12"},[e("h4",null,"My Ratings & Reviews"),e("p",{class:"grey-text"},"View feedback from your clients and track your performance.")])],-1)),e("div",W,[e("div",K,[e("div",Q,[e("div",X,[s[2]||(s[2]=e("h5",null,"Overall Rating",-1)),e("div",Y,[e("span",Z,c(_.value.toFixed(1)),1),e("div",$,[(n(),i(m,null,p(5,t=>e("i",{key:t,class:g(["material-icons star large",t<=_.value?"amber-text":"grey-text text-lighten-2"])}," star ",2)),64))]),e("p",ee,"Based on "+c(b.value)+" reviews",1)])])])]),e("div",se,[e("div",te,[e("div",ae,[s[3]||(s[3]=e("h5",null,"Rating Breakdown",-1)),x(F,{mode:"display","average-rating":_.value,"total-ratings":b.value,"rating-breakdown":N.value,"show-breakdown":!0},null,8,["average-rating","total-ratings","rating-breakdown"])])])])]),e("div",oe,[e("div",ie,[e("div",ne,[e("div",le,[s[7]||(s[7]=e("h5",null,"Performance Categories",-1)),e("div",re,[e("div",de,[s[4]||(s[4]=e("h6",null,"Communication",-1)),e("div",ce,[e("span",ue,c(l.value.communication.toFixed(1)),1),e("div",ve,[(n(),i(m,null,p(5,t=>e("i",{key:t,class:g(["material-icons star",t<=l.value.communication?"amber-text":"grey-text text-lighten-2"])}," star ",2)),64))])])]),e("div",me,[s[5]||(s[5]=e("h6",null,"Helpfulness",-1)),e("div",pe,[e("span",ge,c(l.value.helpfulness.toFixed(1)),1),e("div",he,[(n(),i(m,null,p(5,t=>e("i",{key:t,class:g(["material-icons star",t<=l.value.helpfulness?"amber-text":"grey-text text-lighten-2"])}," star ",2)),64))])])]),e("div",fe,[s[6]||(s[6]=e("h6",null,"Professionalism",-1)),e("div",_e,[e("span",we,c(l.value.professionalism.toFixed(1)),1),e("div",ye,[(n(),i(m,null,p(5,t=>e("i",{key:t,class:g(["material-icons star",t<=l.value.professionalism?"amber-text":"grey-text text-lighten-2"])}," star ",2)),64))])])])])])])])]),e("div",be,[e("div",Re,[e("div",ke,[A(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>v.value=t),onChange:I},[...s[8]||(s[8]=[C('<option value="" data-v-d66a8da5>All Ratings</option><option value="5" data-v-d66a8da5>5 Stars</option><option value="4" data-v-d66a8da5>4 Stars</option><option value="3" data-v-d66a8da5>3 Stars</option><option value="2" data-v-d66a8da5>2 Stars</option><option value="1" data-v-d66a8da5>1 Star</option>',6)])],544),[[S,v.value]]),s[9]||(s[9]=e("label",null,"Filter by Rating",-1))])]),e("div",xe,[e("div",Ae,[A(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>h.value=t),onChange:L},[...s[10]||(s[10]=[e("option",{value:"newest"},"Newest First",-1),e("option",{value:"oldest"},"Oldest First",-1),e("option",{value:"highest"},"Highest Rating",-1),e("option",{value:"lowest"},"Lowest Rating",-1)])],544),[[S,h.value]]),s[11]||(s[11]=e("label",null,"Sort By",-1))])])]),D(w)?(n(),i("div",Se,[...s[12]||(s[12]=[C('<div class="preloader-wrapper active" data-v-d66a8da5><div class="spinner-layer spinner-teal-only" data-v-d66a8da5><div class="circle-clipper left" data-v-d66a8da5><div class="circle" data-v-d66a8da5></div></div><div class="gap-patch" data-v-d66a8da5><div class="circle" data-v-d66a8da5></div></div><div class="circle-clipper right" data-v-d66a8da5><div class="circle" data-v-d66a8da5></div></div></div></div><p data-v-d66a8da5>Loading reviews...</p>',2)])])):k("",!0),e("div",Ce,[e("div",De,[e("div",Fe,[e("div",Me,[s[13]||(s[13]=e("h5",null,"Recent Reviews",-1)),x(F,{mode:"reviews",reviews:V.value},null,8,["reviews"])])])])]),y.value?(n(),i("div",Be,[e("button",{onClick:E,class:"btn waves-effect waves-light teal",disabled:D(w)}," Load More Reviews ",8,Ne)])):k("",!0)])]))}},Ue=z(Ve,[["__scopeId","data-v-d66a8da5"]]);export{Ue as default};
